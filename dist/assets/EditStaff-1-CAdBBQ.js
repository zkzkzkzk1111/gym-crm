import{x as h,G as u,aN as q,aH as B,aI as T,c as j,w as o,o as y,f as a,m as D,h as E,A as r,aO as F,X as L,a7 as M,a3 as S,a4 as i,L as _,H as b,E as P,s as G,Z as H,J as x,b as w,aP as I}from"./index-ChThWpwh.js";import{U as $,_ as A}from"./UiParentCard.vue_vue_type_script_setup_true_lang-CBB4u1YX.js";import{u as J}from"./staff-lYDUuXCw.js";import{s as O}from"./staffService-B334Pa8R.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-D8WuJDhL.js";const X={key:0},Z={class:"d-flex ga-6 mt-8 justify-end"},le=h({__name:"EditStaff",setup(z){const p=q(),v=I(),d=u(""),V=u(!1),f=u(!1),g=u(),n=J(),m=u([]);p.params.id?(d.value="직원 수정",n.fetchById(Number(p.params.id))):(d.value="직원 등록",n.initNewStaff());const{staff:t}=B(n);T(async()=>{try{m.value=await O.getGradeList()}catch(l){console.error("Failed to fetch grade list:",l),m.value=[]}});const c=l=>l?!0:"This field is required.",C=[c,l=>(l==null?void 0:l.length)<=20?!0:"Name must be less than 20 characters."],N=[c,l=>{if(!l)return"Phone is required.";const e=l.toString();return/^[0-9]+$/.test(e)?!0:"Phone must contain only numbers."}];function k(){v.replace({path:"/staffs"})}async function R(l){l.preventDefault();const{valid:e}=await g.value.validate();if(e&&t.value){f.value=!0;let s;if(t.value.idx)s=await n.updateStaff(t.value.idx,t.value);else{const{idx:K,...U}=t.value;s=await n.createStaff(U)}s.success&&v.replace({path:"/staffs"}),f.value=!1}}return(l,e)=>(y(),j($,null,{default:o(()=>[a(A,{title:d.value},{default:o(()=>[!r(n).loading&&r(t)?(y(),D("div",X,[a(F,{ref_key:"form",ref:g,modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=s=>V.value=s),onSubmit:e[5]||(e[5]=L(()=>{},["prevent"]))},{default:o(()=>[a(M,null,{default:o(()=>[a(S,null,{default:o(()=>[a(i,{cols:"12",md:"4"},{default:o(()=>[a(_,{modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=s=>r(t).name=s),rules:C,label:"이름",variant:"solo-filled",required:""},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"4"},{default:o(()=>[a(b,{modelValue:r(t).gender,"onUpdate:modelValue":e[1]||(e[1]=s=>r(t).gender=s),rules:[c],label:"성별",items:["남","여"],variant:"solo-filled",required:""},null,8,["modelValue","rules"])]),_:1}),a(i,{cols:"12",md:"4"},{default:o(()=>[a(_,{modelValue:r(t).phone,"onUpdate:modelValue":e[2]||(e[2]=s=>r(t).phone=s),rules:N,label:"연락처",variant:"solo-filled",required:"",placeholder:"01012345678"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"4"},{default:o(()=>[a(b,{modelValue:r(t).grade,"onUpdate:modelValue":e[3]||(e[3]=s=>r(t).grade=s),items:m.value,"item-title":"name","item-value":"idx",label:"등급",variant:"solo-filled",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),a(P),a(S,{justify:"end"},{default:o(()=>[a(i,{cols:"12",lg:"2",md:"6",sm:"12",justify:"end",class:""},{default:o(()=>[a(H),G("div",Z,[a(x,{loading:f.value,color:"secondary",variant:"flat",type:"submit",onClick:R},{default:o(()=>e[6]||(e[6]=[w(" 수정 ")])),_:1},8,["loading"]),a(x,{onClick:k,color:"primary",variant:"outlined"},{default:o(()=>e[7]||(e[7]=[w(" 취소 ")])),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):E("",!0)]),_:1},8,["title"])]),_:1}))}});export{le as default};
