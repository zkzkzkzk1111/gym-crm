import{d as i}from"./index-ChThWpwh.js";import{a as t}from"./axios-D8WuJDhL.js";const a="/api/purchase",c={async getAll(){return(await t.get(`${a}/getPurchaseList`)).data.data},async getById(r){return(await t.get(`${a}/getPurchaseDetail/${r}`)).data.data},async create(r){return(await t.post(`${a}/createPurchase`,r)).data.data},async createBulk(r){return(await t.post(`${a}/createPurchase`,r)).data.data||[]},async update(r,e){return(await t.put(`${a}/${r}`,e)).data.data},async delete(r){await t.delete(`${a}/${r}`)}},l=i("purchase",{state:()=>({purchases:[],purchase:null,loading:!1,error:null,filter:""}),getters:{filteredPurchases(){if(!this.filter)return this.purchases;const r=this.filter.toLowerCase();return this.purchases.filter(e=>e.name.toLowerCase().includes(r)||e.buyer.toLowerCase().includes(r)||e.phone.includes(r)||e.type.toLowerCase().includes(r))},getByPaymentMethod:r=>e=>r.purchases.filter(s=>s.paymentMethod===e),getByStatus:r=>e=>r.purchases.filter(s=>s.status===e)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{this.purchases=await c.getAll()}catch(r){this.error=r instanceof Error?r.message:"Failed to fetch purchases",console.error("Error fetching purchases:",r)}finally{this.loading=!1}},async fetchById(r){this.loading=!0,this.error=null;try{this.purchase=await c.getById(r)}catch(e){this.error=e instanceof Error?e.message:"Failed to fetch purchase",console.error("Error fetching purchase:",e)}finally{this.loading=!1}},async createPurchase(r){this.loading=!0,this.error=null;try{const e=await c.create(r);return this.purchases.push(e),{success:!0,data:e}}catch(e){return this.error=e instanceof Error?e.message:"Failed to create purchase",console.error("Error creating purchase:",e),{success:!1,error:this.error}}finally{this.loading=!1}},async createPurchaseBulk(r){this.loading=!0,this.error=null;try{const e=await c.createBulk(r);return Array.isArray(e)&&e.length>0?this.purchases.push(...e):e&&this.purchases.push(e),{success:!0,data:e}}catch(e){return this.error=e instanceof Error?e.message:"Failed to create purchases",console.error("Error creating purchases:",e),{success:!1,error:this.error}}finally{this.loading=!1}},async updatePurchase(r,e){this.loading=!0,this.error=null;try{const s=await c.update(r,e),o=this.purchases.findIndex(n=>n.idx===r);return o!==-1&&(this.purchases[o]=s),{success:!0,data:s}}catch(s){return this.error=s instanceof Error?s.message:"Failed to update purchase",console.error("Error updating purchase:",s),{success:!1,error:this.error}}finally{this.loading=!1}},async deletePurchase(r){this.loading=!0,this.error=null;try{return await c.delete(r),this.purchases=this.purchases.filter(e=>e.idx!==r),{success:!0}}catch(e){return this.error=e instanceof Error?e.message:"Failed to delete purchase",console.error("Error deleting purchase:",e),{success:!1,error:this.error}}finally{this.loading=!1}},initNewPurchase(){this.purchase={idx:0,type:"",name:"",buyer:"",cnt:0,price:0,paymentMethod:"",paidAt:"",status:0,phone:"",statusName:""}}}});export{l as u};
