import{d as o}from"./index-ChThWpwh.js";import{a as s}from"./axios-D8WuJDhL.js";const a="/api/member",n={async getAll(){return(await s.get(`${a}/getMemberList`)).data.data},async getById(e){return(await s.get(`${a}/getMemberDetail/${e}`)).data.data},async create(e){return(await s.post(`${a}/writeMember`,e)).data.data},async update(e,r){return(await s.put(`${a}/${e}`,r)).data.data},async delete(e){await s.delete(`${a}/deleteMember/${e}`)},async search(e){return(await s.get(`${a}/search`,{params:{keyword:e}})).data.data},async getByStatus(e){return(await s.get(`${a}/status/${e}`)).data.data}},u=o("Members",{state:()=>({members:[],member:null,loading:!1,error:null,filter:""}),getters:{filteredMembers(){if(!this.filter)return this.members;const e=this.filter.toLowerCase();return this.members.filter(r=>{var t;return r.userName.toLowerCase().includes(e)||r.phone.includes(e)||(((t=r.consultantName)==null?void 0:t.toLowerCase().includes(e))??!1)})},activeMembers(){return this.members.filter(e=>e.status===1)},expiringMembers(){return this.members.filter(e=>e.dayNum!==null&&e.dayNum<=7&&e.dayNum>0)}},actions:{async fetchAll(){this.loading=!0,this.error=null;try{this.members=await n.getAll()}catch(e){this.error=e instanceof Error?e.message:"Failed to fetch members",console.error("Error fetching members:",e)}finally{this.loading=!1}},async fetchById(e){this.loading=!0,this.error=null;try{this.member=await n.getById(e)}catch(r){this.error=r instanceof Error?r.message:"Failed to fetch member",console.error("Error fetching member:",r)}finally{this.loading=!1}},async createMember(e){this.loading=!0,this.error=null;try{const r=await n.create(e);return this.members.push(r),{success:!0,data:r}}catch(r){return this.error=r instanceof Error?r.message:"Failed to create member",console.error("Error creating member:",r),{success:!1,error:this.error}}finally{this.loading=!1}},async updateMember(e,r){this.loading=!0,this.error=null;try{const t=await n.update(e,r),l=this.members.findIndex(i=>i.idx===e);return l!==-1&&(this.members[l]=t),{success:!0,data:t}}catch(t){return this.error=t instanceof Error?t.message:"Failed to update member",console.error("Error updating member:",t),{success:!1,error:this.error}}finally{this.loading=!1}},async deleteMember(e){this.loading=!0,this.error=null;try{return await n.delete(e),this.members=this.members.filter(r=>r.idx!==e),{success:!0}}catch(r){return this.error=r instanceof Error?r.message:"Failed to delete member",console.error("Error deleting member:",r),{success:!1,error:this.error}}finally{this.loading=!1}},async searchMembers(e){this.loading=!0,this.error=null;try{this.members=await n.search(e)}catch(r){this.error=r instanceof Error?r.message:"Failed to search members",console.error("Error searching members:",r)}finally{this.loading=!1}},initNewMember(){this.member={idx:0,userName:"",status:1,gender:"",birth:null,age:null,phone:"",getUtilization:null,getRenting:null,locker:null,sort:0,regDt:null,endDt:null,dayNum:null,regentRegDt:null,regentAtDt:null,AtNum:null,etcComment:null,purpose:null,visitPath:null,consultant:null,address:null,lockerName:null,getRentingName:null,getUtilizationName:null,purposeName:null,visitPathName:null,consultantName:null}}}});export{n as m,u};
