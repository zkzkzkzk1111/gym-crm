import{x as q,G as u,aN as U,aH as B,aI as F,c as T,w as s,o as b,f as a,m as j,h as E,A as r,aO as L,X as M,a7 as P,a3 as y,a4 as d,L as _,H as x,E as D,s as G,Z as H,J as h,b as w,aP as I}from"./index-ChThWpwh.js";import{U as $,_ as A}from"./UiParentCard.vue_vue_type_script_setup_true_lang-CBB4u1YX.js";import{u as J}from"./staff-lYDUuXCw.js";import{s as O}from"./staffService-B334Pa8R.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-D8WuJDhL.js";const X={key:0},Z={class:"d-flex ga-6 mt-8 justify-end"},te=q({__name:"StaffForm",setup(z){const c=U(),v=I(),i=u(""),V=u(!1),f=u(!1),g=u(),n=J(),m=u([]);c.params.id?(i.value="Edit Staff",n.fetchById(Number(c.params.id))):(i.value="직원 등록",n.initNewStaff());const{staff:t}=B(n);F(async()=>{try{m.value=await O.getGradeList()}catch(l){console.error("Failed to fetch grade list:",l),m.value=[]}});const p=l=>l?!0:"This field is required.",C=[p,l=>(l==null?void 0:l.length)<=20?!0:"Name must be less than 20 characters."],N=[p,l=>{if(!l)return"Phone is required.";const e=l.toString();return/^[0-9]+$/.test(e)?!0:"Phone must contain only numbers."}];function R(){v.replace({path:"/staffs"})}async function k(l){l.preventDefault();const{valid:e}=await g.value.validate();if(e&&t.value){f.value=!0;let o;const S={name:t.value.name,grade:t.value.grade,phone:t.value.phone?Number(t.value.phone):null,gender:t.value.gender};t.value.idx?o=await n.updateStaff(t.value.idx,S):o=await n.createStaff(S),o.success&&v.replace({path:"/staffs"}),f.value=!1}}return(l,e)=>(b(),T($,null,{default:s(()=>[a(A,{title:i.value},{default:s(()=>[!r(n).loading&&r(t)?(b(),j("div",X,[a(L,{ref_key:"form",ref:g,modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=o=>V.value=o),onSubmit:e[5]||(e[5]=M(()=>{},["prevent"]))},{default:s(()=>[a(P,null,{default:s(()=>[a(y,null,{default:s(()=>[a(d,{cols:"12",md:"4"},{default:s(()=>[a(_,{modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>r(t).name=o),rules:C,label:"이름",variant:"solo-filled",required:""},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(x,{modelValue:r(t).gender,"onUpdate:modelValue":e[1]||(e[1]=o=>r(t).gender=o),rules:[p],label:"성별",items:["남","여"],variant:"solo-filled",required:""},null,8,["modelValue","rules"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(_,{modelValue:r(t).phone,"onUpdate:modelValue":e[2]||(e[2]=o=>r(t).phone=o),rules:N,label:"연락처",variant:"solo-filled",required:"",placeholder:"01012345678"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(x,{modelValue:r(t).grade,"onUpdate:modelValue":e[3]||(e[3]=o=>r(t).grade=o),items:m.value,"item-title":"name","item-value":"idx",label:"등급",variant:"solo-filled",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),a(D),a(y,{justify:"end"},{default:s(()=>[a(d,{cols:"12",lg:"2",md:"6",sm:"12",justify:"end",class:""},{default:s(()=>[a(H),G("div",Z,[a(h,{loading:f.value,color:"secondary",variant:"flat",type:"submit",onClick:k},{default:s(()=>e[6]||(e[6]=[w(" 등록 ")])),_:1},8,["loading"]),a(h,{onClick:R,color:"primary",variant:"outlined"},{default:s(()=>e[7]||(e[7]=[w(" 취소 ")])),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):E("",!0)]),_:1},8,["title"])]),_:1}))}});export{te as default};
