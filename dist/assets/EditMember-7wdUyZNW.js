import{x as S,G as u,aN as q,aH as D,aI as y,c as F,w as r,o as w,f as l,m as E,h as T,A as s,aO as Y,X as j,a7 as I,a3 as h,a4 as i,L as n,H as m,E as H,s as $,Z as A,J as C,b as P,aP as G}from"./index-ChThWpwh.js";import{U as J,_ as O}from"./UiParentCard.vue_vue_type_script_setup_true_lang-CBB4u1YX.js";import{u as X}from"./members-BzmwLjda.js";import{a as g}from"./axios-D8WuJDhL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={key:0},z={class:"d-flex ga-6 mt-8 justify-end"},oe=S({__name:"EditMember",setup(K){const x=q(),M=G(),f=u(""),N=u(!1),p=u(!1),U=u(),d=X(),v=u([]),V=u([]),c=u([]);x.params.id?(f.value="Edit Member",d.fetchById(Number(x.params.id))):(f.value="회원 등록",d.initNewMember());const{member:a}=D(d);y(async()=>{try{const o=await g.get("/api/common/getPurposeList");v.value=o.data.data}catch(o){console.error("Failed to fetch purpose list:",o),v.value=[]}}),y(async()=>{try{const o=await g.get("/api/common/getVisitPathList");V.value=o.data.data}catch(o){console.error("Failed to fetch visitpath list:",o),V.value=[]}}),y(async()=>{try{const o=await g.get("/api/member/getStaffList");c.value=o.data.data}catch(o){console.error("Failed to fetch staff list:",o),c.value=[]}});const b=o=>o?!0:"This field is required.",_=[b,o=>(o==null?void 0:o.length)<=20?!0:"Name must be less than 20 characters."],k=[b,o=>/^[0-9-]+$/.test(o)?!0:"Phone must contain only numbers and hyphens."];function L(){M.replace({path:"/members"})}async function R(o){o.preventDefault();const{valid:e}=await U.value.validate();if(e&&a.value){p.value=!0;let t;if(a.value.idx)t=await d.updateMember(a.value.idx,a.value);else{const{idx:Q,...B}=a.value;t=await d.createMember(B)}t.success&&M.replace({path:"/members"}),p.value=!1}}return(o,e)=>(w(),F(J,null,{default:r(()=>[l(O,{title:f.value},{default:r(()=>[!s(d).loading&&s(a)?(w(),E("div",Z,[l(Y,{ref_key:"form",ref:U,modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=t=>N.value=t),onSubmit:e[10]||(e[10]=j(()=>{},["prevent"]))},{default:r(()=>[l(I,null,{default:r(()=>[l(h,null,{default:r(()=>[l(i,{cols:"12",md:"4"},{default:r(()=>[l(n,{modelValue:s(a).userName,"onUpdate:modelValue":e[0]||(e[0]=t=>s(a).userName=t),rules:_,label:"이름",variant:"solo-filled",required:""},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"4"},{default:r(()=>[l(m,{modelValue:s(a).gender,"onUpdate:modelValue":e[1]||(e[1]=t=>s(a).gender=t),rules:[b],label:"성별",items:["남","여"],variant:"solo-filled",required:""},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"4"},{default:r(()=>[l(n,{modelValue:s(a).birth,"onUpdate:modelValue":e[2]||(e[2]=t=>s(a).birth=t),modelModifiers:{number:!0},type:"number",label:"생년월일 (예: 19900101)",variant:"solo-filled",placeholder:"YYYYMMDD"},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"4"},{default:r(()=>[l(n,{modelValue:s(a).age,"onUpdate:modelValue":e[3]||(e[3]=t=>s(a).age=t),modelModifiers:{number:!0},type:"number",label:"나이",variant:"solo-filled"},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"4"},{default:r(()=>[l(n,{modelValue:s(a).phone,"onUpdate:modelValue":e[4]||(e[4]=t=>s(a).phone=t),rules:k,label:"연락처",variant:"solo-filled",required:"",placeholder:"010-1234-5678"},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"4"},{default:r(()=>[l(m,{modelValue:s(a).consultant,"onUpdate:modelValue":e[5]||(e[5]=t=>s(a).consultant=t),items:c.value,"item-title":"name","item-value":"idx",label:"상담자",variant:"solo-filled",clearable:""},null,8,["modelValue","items"])]),_:1}),l(i,{cols:"12",md:"4"},{default:r(()=>[l(m,{modelValue:s(a).visitPath,"onUpdate:modelValue":e[6]||(e[6]=t=>s(a).visitPath=t),items:V.value,"item-title":"visitPathName","item-value":"idx",label:"방문 경로",variant:"solo-filled",clearable:""},null,8,["modelValue","items"])]),_:1}),l(i,{cols:"12",md:"4"},{default:r(()=>[l(m,{modelValue:s(a).purpose,"onUpdate:modelValue":e[7]||(e[7]=t=>s(a).purpose=t),items:v.value,"item-title":"purposeName","item-value":"idx",label:"운동 목적",variant:"solo-filled",clearable:""},null,8,["modelValue","items"])]),_:1}),l(i,{cols:"12",md:"8"},{default:r(()=>[l(n,{modelValue:s(a).address,"onUpdate:modelValue":e[8]||(e[8]=t=>s(a).address=t),label:"주소",variant:"solo-filled"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(H),l(h,{justify:"end"},{default:r(()=>[l(i,{cols:"12",lg:"2",md:"6",sm:"12",justify:"end",class:""},{default:r(()=>[l(A),$("div",z,[l(C,{loading:p.value,color:"secondary",variant:"flat",type:"submit",onClick:R},{default:r(()=>e[11]||(e[11]=[P(" 수정 ")])),_:1},8,["loading"]),l(C,{onClick:L,color:"primary",variant:"outlined"},{default:r(()=>e[12]||(e[12]=[P(" 취소 ")])),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):T("",!0)]),_:1},8,["title"])]),_:1}))}});export{oe as default};
